<!doctype linuxdoc system>
<article>
<title>Squid 3.2.0.0 release notes</title>
<author>Squid Developers</author>

<abstract>
This document contains the release notes for version 3.2 of Squid.
Squid is a WWW Cache application developed by the National Laboratory
for Applied Network Research and members of the Web Caching community.
</abstract>

<toc>

<sect>Notice
<p>
The Squid Team are pleased to announce the release of Squid-3.2.0.0 for testing.

This new release is available for download from <url url="http://www.squid-cache.org/Versions/v3/3.2/"> or the <url url="http://www.squid-cache.org/Mirrors/http-mirrors.html" name="mirrors">.

While this release is not deemed ready for production use, we believe it is ready for wider testing by the community.

We welcome feedback and bug reports. If you find a bug, please see <url url="http://wiki.squid-cache.org/SquidFaq/TroubleShooting#head-7067fc0034ce967e67911becaabb8c95a34d576d"> for how to submit a report with a stack trace.

<sect1>Known issues
<p>
Although this release is deemed good enough for use in many setups, please note the existence of <url url="http://www.squid-cache.org/bugs/buglist.cgi?query_format=advanced&amp;short_desc_type=allwordssubstr&amp;short_desc=&amp;target_milestone=3.2&amp;long_desc_type=allwordssubstr&amp;long_desc=&amp;bug_file_loc_type=allwordssubstr&amp;bug_file_loc=&amp;status_whiteboard_type=allwordssubstr&amp;status_whiteboard=&amp;bug_status=NEW&amp;bug_status=ASSIGNED&amp;bug_status=REOPENED&amp;emailtype1=substring&amp;email1=&amp;emailtype2=substring&amp;email2=&amp;bugidtype=include&amp;bug_id=&amp;votes=&amp;chfieldfrom=&amp;chfieldto=Now&amp;chfieldvalue=&amp;cmdtype=doit&amp;order=bugs.bug_severity&amp;field0-0-0=noop&amp;type0-0-0=noop&amp;value0-0-0=" name="open bugs against Squid-3.2">.

<sect1>Changes since earlier releases of Squid-3.2
<p>
The 3.2 change history can be <url url="http://www.squid-cache.org/Versions/v3/3.2/changesets/" name="viewed here">.

<sect>Major new features since Squid-3.1
<p>Squid 3.2 represents a new feature release above 3.1.

<p>The most important of these new features are:
<itemize>
	<item>Helper Multiplexer
	<item>Helper Name Changes
	<item>Multi-Lingual manuals
	<item>Solaris 10 pthreads Support (Experimental)
</itemize>

Most user-facing changes are reflected in squid.conf (see below).

<sect1>Helper Multiplexer
<p>The helper multiplexer's purpose is to relieve some of the burden
   Squid has when dealing with slow helpers. It does so by acting as a
   middleman between squid and the actual helpers, talking to Squid via
   the multiplexed concurrent variant of the helper protocol and to the
   helpers via the non-concurrent variant.

<p>Helpers are started on demand, and in theory the muxer can handle up to
   1k helpers per instance. It's up to squid to decide how many helpers
   to start.

<p>The muxer knows nothing about the actual messages being passed around,
   and as such can't really (yet?) compensate for broken helpers.
   It is not yet able to manage dying helpers, but it will.

<p>To configure the multiplexer add its binary name (usually /usr/share/libexec/helper-mux.pl)
   in front of the name of whichever helper is being multiplexed. It takes the helper binary
   path and parameters as its own command parameters. The <em>concurrency</em> setting already
   existing in Squid is used to configure how many child helpers it may run.

<p>For example, a traditional configration is
   <verb>
	url_rewrite_program /your/redirector.sh
	url_rewrite_children 5
   </verb>
   the alternative multiplexer configuration is:
   <verb>
	url_rewrite_program /usr/share/libexec/helper-mux.pl /your/redirector.sh
	url_rewrite_children 1 concurrency=5
   </verb>

<p>Helpers which are already concurrent protocol enabled gain little benefit from the multiplexer
   on most systems. However on some systems where Squid spawning helpers causes excess memory usage
   the reduction in direct helper spawned by Squid can result in a great reduction in resource use.

<p>The helper can be controlled using various signals:
   <itemize>
	<item>SIGHUP: dump the state of all helpers to STDERR
   </itemize>

<sect1>Helper Name Changes

<p>To improve the understanding of what each helper does and where it should be used the helper binaries
   which are bundled with Squid have undergone a naming change in this release.

<p>Below is a list of the old helper names and what their names have changed to.
   For several helpers the directory name used in --enable-X-helpers configure option has also changed.

<sect2>Basic Authentication protocol helpers
<p><itemize>
	<item>squid_db_auth - basic_db_auth - Retrieve authentication details from a simple SQL database table.
	<item>getpwnam_auth - basic_getpwname_auth - Authenticate with local system user accounts.
	<item>squid_ldap_auth - basic_ldap_auth - Authenticate with LDAP user accounts.
	<item>ncsa_auth - basic_ncsa_auth - Authenticate with NCSA httpd-style password file.
	<item>pam_auth - basic_pam_auth - Authenticate with the system PAM infrastructure.
	<item>pop3.pl - basic_pop3_auth.pl - Authenticate with a mail server POP3/SMTP credentials
	<item>squid_sasl_auth - basic_sasl_auth - Authenticate with SASL.
	<item>smb_auth - basic_smb_auth - Authenticate with Samba SMB.
	<item>yp_auth - basic_nis_auth - Authenticate with NIS security system.
	<item>mswin_sspi - basic_sspi_auth - Authenticate with a Windows Domain Controller using SSPI.
	<item>MSNT-multi-domain - basic_msnt_multi_domain_auth.pl - Authenticate with any one of multiple Windows Domain Controllers.
	<item>squid_radius_auth - basic_radius_auth - Authenticate with RADIUS.
</itemize>

<sect2>Digest Authentication protocol helpers
<p><itemize>
	<item>(none yet converted)
</itemize>

<sect2>External ACL helpers
<p><itemize>
	<item>(none yet converted)
</itemize>

<sect2>Negotiate Authentication protocol helpers
<p><itemize>
	<item>squid_kerb_auth - negotiate_kerberos_auth - Authenticate with Kerberos servers.
</itemize>

<sect2>NTLM Authentication protocol helpers
<p><itemize>
	<item>ntlm_auth - ntlm_smb_lm_auth - Perform SMB LanManager domain-less authentication over NTLM protocol.
</itemize>

<sect2>URL re-write helpers
<p>This group of helpers have been bundled to demonstrate how to code URL re-writers:
<itemize>
	<item>url_fake_rewrite - Accept various url_rewrite details and log the input.
</itemize>


<sect1>Multi-Lingual manuals

<p>The man(8) and man(1) pages bundled with Squid are now provided online for all
   versions and beginning with 3.2 they are available in languages other than english.

<p>Details in <url url="http://wiki.squid-cache.org/Features/QualityOfService" name="The Squid wiki">

<p>3.1 began the Internationalization of Squid with the public facing error pages.
   This move begins the Localization of the internal administrator facing manuals.

<sect1>Solaris 10 pthreads Support (Experimental)

<p>Automatic detection and use of the pthreads library available from Solaris 10

<sect>Changes to squid.conf since Squid-3.1
<p>
There have been changes to Squid's configuration file since Squid-3.1.

This section gives a thorough account of those changes in three categories:

<itemize>
	<item><ref id="newtags" name="New tags">
	<item><ref id="modifiedtags" name="Changes to existing tags">
	<item><ref id="removedtags" name="Removed tags">
</itemize>
<p>

<sect1>New tags<label id="newtags">
<p>
<descrip>
	<tag>eui_lookup</tag>
	<p> Whether to lookup the EUI or MAC address of a connected client.

	<tag>memory_cache_mode</tag>
	<p> Controls which objects to keep in the memory cache (cache_mem)
	<verb>
	'always'  Keep most recently fetched objects in memory (default)
	
	'disk'    Only disk cache hits are kept in memory, which means
	          an object must first be cached on disk and then hit
	          a second time before cached in memory.
	
	network   Only objects fetched from network is kept in memory
	</verb>

	<tag>logfile_daemon</tag>
	<p>Ported from 2.7

</descrip>

<sect1>Changes to existing tags<label id="modifiedtags">
<p>
<descrip>
	<tag>acl random</tag>
	<p>New type <em>random</em>. Pseudo-randomly match requests based on a configured probability.

	<tag>auth_param</tag>
	<p>New options for Basic, Digest, NTLM, Negotiate <em>children</em> settings.
	   <em>startup=N</em> determins minimum number of helper processes used.
	   <em>idle=N</em> determines how many helper to retain as buffer against sudden traffic loads.
	   <em>concurrency=N</em> previously called <em>auth_param ... concurrency</em> as a separate option.
	<p>Removed Basic, Digest, NTLM, Negotiate <em>auth_param ... concurrency</em> setting option.

	<tag>deny_info</tag>
	<p>Support URL format tags. For dynamically generated URL in denial redirect.

	<tag>external_acl_type</tag>
	<p>New format tags and option parameters:
	<p><em>%SRCEUI48</em> EUI-48 / MAC address of client from ARP lookup.
	<p><em>%SRCEUI64</em> EUI-64 of clients with SLAAC address.
	<p><em>children-max=N</em> determins maximum number of helper processes used.
	<p><em>children-startup=N</em> determins minimum number of helper processes used.
	<p><em>children-idle=N</em> determines how many helper to retain as buffer against sudden traffic loads.
	<p>Deprecated <em>children=N</em> in favor of <em>children-max=N</em>.

	<tag>logformat</tag>
	<p><em>%sn</em> Unique sequence number per log line. Ported from 2.7
	<p><em>%>eui</em> EUI logging (EUI-48 / MAC address for IPv4, EUI-64 for IPv6)
	   Both EUI forms are logged in the same field. Type can be identified by length or byte delimiter.

	<tag>windows_ipaddrchangemonitor</tag>
	<p>Now only available to be set in Windows builds.

	<tag>url_rewrite_children</tag>
	<p>New options <em>startup=N</em>, <em>idle=N</em>, <em>concurrency=N</em>
	<itemize>
		<item>startup=N allow finer tuning of how many helpers are started initially.
		<item>idle=N allow fine tuning of how many helper to retain as buffer against sudden traffic loads.
		<item>concurrency=N was previously called url_rewrite_concurrency as a distinct directive.
	</itemize>

</descrip>


<sect1>Removed tags<label id="removedtags">
<p>
<descrip>
	<tag>ftp_list_width</tag>
	<p>Obsolete.

	<tag>url_rewrite_concurrency</tag>
	<p>Replaced by url_rewrite_children ... concurrency=N option.

</descrip>


<sect>Changes to ./configure options since Squid-3.1
<p>
There have been some changes to Squid's build configuration since Squid-3.1.

This section gives an account of those changes in three categories:

<itemize>
	<item><ref id="newoptions" name="New options">
	<item><ref id="modifiedoptions" name="Changes to existing options">
	<item><ref id="removedoptions" name="Removed options">
</itemize>


<sect1>New options<label id="newoptions">
<p>
<descrip>
	<tag>--enable-eui</tag>
	<p>Enable Support for handling EUI operations.
	   This includes ARP lookups for MAC (EUI-48) addresses and the ACL arp type tests.

	<tag>--enable-url-rewrite-helpers</tag>
	<p>Build helpers for some basic URL-rewrite actions. For use by url_rewrite_program.
	   If omitted or set to =all then all bundled helpers that are able to build will be built.
	   If set to a specific list of helpers then only those helpers will build.
	   Currently one demo helper <em>fake</em> is provided in shell and C++ forms to demonstrate
	   the helper protocol usage and provide exemplar code.

</descrip>

<sect1>Changes to existing options<label id="modifiedoptions">
<p>
<descrip>
	<tag>???alphabetical list within group ordered: enable, disable, with, without) ???</tag>
	<p> ???explain??

</descrip>
</p>

<sect1>Removed options<label id="removedoptions">
<p>
<descrip>
	<tag>--enable-arp-acl</tag>
	<p>Replaced by --enable-eui

</descrip>


<sect>Options Removed since Squid-2

<p>Some squid.conf and ./configure options which were available in Squid-2.6 and Squid-2.7 are made obsolete in Squid-3.2.

<sect1>Removed squid.conf options since Squid-2.7
<p>
<descrip>
	<tag>auth_param</tag>
	<p><em>blankpassword</em> option for basic scheme removed.

	<tag>external_acl_type</tag>
	<p>Format tag <em>%{Header}</em> replaced by <em>%>{Header}</em>
	<p>Format tag <em>%{Header:member}</em> replaced by <em>%>{Header:member}</em>

	<tag>header_access</tag>
	<p>Replaced by <em>request_header_access</em> and <em>reply_header_access</em>

	<tag>http_port</tag>
	<p><em>no-connection-auth</em> replaced by <em>connection-auth=[on|off]</em>. Default is ON.
	<p><em>transparent</em> option replaced by <em>intercept</em>

	<tag>httpd_accel_no_pmtu_disc</tag>
	<p>Replaced by <em>http_port disable-pmtu-discovery=</em> option

	<tag>incoming_rate</tag>
	<p>Obsolete.

	<tag>redirector_bypass</tag>
	<p>Replaced by <em>url_rewrite_bypass</em>

	<tag>upgrade_http0.9</tag>
	<p>Obsolete.

	<tag>zph_local</tag>
	<p>Replaced by <em>qos_flows local-hit=</em>

	<tag>zph_mode</tag>
	<p>Obsolete.

	<tag>zph_option</tag>
	<p>Obsolete.

	<tag>zph_parent</tag>
	<p>Replaced by <em>qos_flows parent-hit=</em>

	<tag>zph_sibling</tag>
	<p>Replaced by <em>qos_flows sibling-hit=</em>

</descrip>

<sect1>Removed squid.conf options since Squid-2.6
<p>
<descrip>
	<tag>cache_dir</tag>
	<p><em>read-only</em> option replaced by <em>no-store</em>.

</descrip>

<sect1>Removed ./configure options since Squid-2.7
<p>
<descrip>
	<tag>--enable-coss-aio-ops</tag>
	<p>Obsolete.

	<tag>--enable-devpoll</tag>
	<p>Replaced by automatic detection.

	<tag>--enable-dlmalloc=LIB</tag>
	<p>Obsolete.

	<tag>--enable-epoll</tag>
	<p>Replaced by automatic detection.

	<tag>--enable-forward-log</tag>
	<p>Obsolete.

	<tag>--enable-heap-replacement</tag>
	<p>Obsolete.

	<tag>--enable-htcp</tag>
	<p>Obsolete. Enabled by default.

	<tag>--enable-large-cache-files</tag>
	<p>Obsolete.

	<tag>--enable-mempool-debug</tag>
	<p>Obsolete.

	<tag>--enable-multicast-miss</tag>
	<p>Obsolete.

	<tag>--enable-poll</tag>
	<p>Replaced by automatic detection.

	<tag>--enable-select</tag>
	<p>Replaced by automatic detection.

	<tag>--enable-select-simple</tag>
	<p>Replaced by automatic detection.

	<tag>--enable-snmp</tag>
	<p>Obsolete. Enabled by default.

	<tag>--enable-truncate</tag>
	<p>Obsolete.

	<tag>--disable-kqueue</tag>
	<p>Obsolete. Disabled by default.

</descrip>


<sect>Regressions since Squid-2.7

<p>Some squid.conf and ./configure options which were available in Squid-2.7 are not yet available in Squid-3.2

<p>If you need something to do then porting one of these from Squid-2 to Squid-3 is most welcome.

<sect1>Missing squid.conf options available in Squid-2.7
<p>
<descrip>
	<tag>acl</tag>
	<p><em>urllogin</em> option not yet ported from 2.6
	<p><em>urlgroup</em> option not yet ported from 2.6

	<tag>authenticate_ip_shortcircuit_access</tag>
	<p>Not yet ported from 2.7

	<tag>authenticate_ip_shortcircuit_ttl</tag>
	<p>Not yet ported from 2.7

	<tag>broken_vary_encoding</tag>
	<p>Not yet ported from 2.6

	<tag>cache_dir</tag>
	<p><em>min-size</em> option not yet ported from Squid-2
	<p><em>COSS</em> storage type is lacking stability fixes from 2.6
	<p>COSS <em>overwrite-percent=</em> option not yet ported from 2.6
	<p>COSS <em>max-stripe-waste=</em> option not yet ported from 2.6
	<p>COSS <em>membufs=</em> option not yet ported from 2.6
	<p>COSS <em>maxfullbufs=</em> option not yet ported from 2.6

	<tag>cache_peer</tag>
	<p><em>multicast-siblings</em> not yet ported from 2.7
	<p><em>idle=</em> not yet ported from 2.7
	<p><em>http11</em> not yet ported from 2.7
	<p><em>monitorinterval=</em> not yet ported from 2.6
	<p><em>monitorsize=</em> not yet ported from 2.6
	<p><em>monitortimeout=</em> not yet ported from 2.6
	<p><em>monitorurl=</em> not yet ported from 2.6

	<tag>cache_vary</tag>
	<p>Not yet ported from 2.6

	<tag>collapsed_forwarding</tag>
	<p>Not yet ported from 2.6

	<tag>error_map</tag>
	<p>Not yet ported from 2.6

	<tag>external_acl_type</tag>
	<p><em>%ACL</em> format tag not yet ported from 2.6
	<p><em>%DATA</em> format tag not yet ported from 2.6

	<tag>external_refresh_check</tag>
	<p>Not yet ported from 2.7

	<tag>http_access2</tag>
	<p>Not yet ported from 2.6

	<tag>http_port</tag>
	<p><em>act-as-origin</em> not yet ported from 2.7
	<p><em>http11</em> not yet ported from 2.7
	<p><em>urlgroup=</em> not yet ported from 2.6

	<tag>ignore_expect_100</tag>
	<p>Not yet ported from 2.7

	<tag>ignore_ims_on_miss</tag>
	<p>Not yet ported from 2.7

	<tag>location_rewrite_access</tag>
	<p>Not yet ported from 2.6

	<tag>location_rewrite_children</tag>
	<p>Not yet ported from 2.6

	<tag>location_rewrite_concurrency</tag>
	<p>Not yet ported from 2.6

	<tag>location_rewrite_program</tag>
	<p>Not yet ported from 2.6

	<tag>logformat</tag>
	<p><em>%oa</em> tag not yet ported from 2.7

	<tag>max_filedescriptors</tag>
	<p>Not yet ported from 2.7

	<tag>max_stale</tag>
	<p>Not yet ported from 2.7

	<tag>refresh_pattern</tag>
	<p><em>stale-while-revalidate=</em> not yet ported from 2.7
	<p><em>ignore-stale-while-revalidate=</em> not yet ported from 2.7
	<p><em>max-stale=</em> not yet ported from 2.7
	<p><em>negative-ttl=</em> not yet ported from 2.7

	<tag>refresh_stale_hit</tag>
	<p>Not yet ported from 2.7

	<tag>server_http11</tag>
	<p>Not yet ported from 2.7

	<tag>storeurl_access</tag>
	<p>Not yet ported from 2.7

	<tag>storeurl_rewrite_children</tag>
	<p>Not yet ported from 2.7

	<tag>storeurl_rewrite_concurrency</tag>
	<p>Not yet ported from 2.7

	<tag>storeurl_rewrite_program</tag>
	<p>Not yet ported from 2.7
	
	<tag>update_headers</tag>
	<p>Not yet ported from 2.7

	<tag>zero_buffers</tag>
	<p>Not yet ported from 2.7

</descrip>

<sect1>Missing ./configure options available in Squid-2.7
<p>
<descrip>
	<tag>--without-system-md5</tag>

</descrip>

</article>

## Copyright (C) 1996-2018 The Squid Software Foundation and contributors
##
## Squid software is distributed under GPLv2+ license and includes
## contributions from numerous individuals and organizations.
## Please see the COPYING and CONTRIBUTORS files for details.
##

#
# The following port configurations check all 50 possible permutations of these
# configs. Among those, the negative ones (unsupported and invalid) are
# currently commented out. TODO: Check each negative test case in isolation.
#
#  A) certificate(s):
#    1) leaf only         tls-cert=./leaf-rsa.*
#    2) full chain        tls-cert=./leaf-root-rsa.*
#    3) root CA           tls-cert=./ca-root-rsa.*
#    4) incomplete chain  tls-cert=./ca-mid-rsa.*
#    5) omitted (no tls-cert for B1 or key-only tls-cert for B2)
#
#  B) signing certificate key:
#    1) in a dedicated file         tls-key=./*.pkey
#    2) in a tls-cert file          tls-cert=./*.pem
#
#  C) tls-generate-host-certificates values:
#    1) omitted
#    2) on                tls-generate-host-certificates=on
#    3) off               tls-generate-host-certificates=off
#    4) auto              tls-generate-host-certificates
#    5) FILE              tls-generate-host-certificates=./ca-mid-root-rsa.pem
#
# Test permutation can be identified by the IP address used.
# Which has the form: 127.A.B.C
#

https_port 127.1.1.1:8443 \
	tls-cert=./leaf-rsa.crt \
	tls-key=./leaf-rsa.pkey

https_port 127.1.1.2:8443 \
	tls-cert=./leaf-rsa.crt \
	tls-key=./leaf-rsa.pkey \
	tls-generate-host-certificates=on

https_port 127.1.1.3:8443 \
	tls-cert=./leaf-rsa.crt \
	tls-key=./leaf-rsa.pkey \
	tls-generate-host-certificates=off

https_port 127.1.1.4:8443 \
	tls-cert=./leaf-rsa.crt \
	tls-key=./leaf-rsa.pkey \
	tls-generate-host-certificates

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
#https_port 127.1.1.5:8443 \
#	tls-cert=./leaf-rsa.crt \
#	tls-key=./leaf-rsa.pkey \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

https_port 127.1.2.1:8443 \
	tls-cert=./leaf-key-rsa.pem

https_port 127.1.2.2:8443 \
	tls-cert=./leaf-key-rsa.pem \
	tls-generate-host-certificates=on

https_port 127.1.2.3:8443 \
	tls-cert=./leaf-key-rsa.pem \
	tls-generate-host-certificates=off

https_port 127.1.2.4:8443 \
	tls-cert=./leaf-key-rsa.pem \
	tls-generate-host-certificates

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
#https_port 127.1.2.5:8443 \
#	tls-cert=./leaf-key-rsa.pem \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

https_port 127.2.1.1:8443 \
	tls-cert=./leaf-chain-nokey-rsa.pem \
	tls-key=./leaf-rsa.pkey

https_port 127.2.1.2:8443 \
	tls-cert=./leaf-chain-nokey-rsa.pem \
	tls-key=./leaf-rsa.pkey \
	tls-generate-host-certificates=on

https_port 127.2.1.3:8443 \
	tls-cert=./leaf-chain-nokey-rsa.pem \
	tls-key=./leaf-rsa.pkey \
	tls-generate-host-certificates=off

https_port 127.2.1.4:8443 \
	tls-cert=./leaf-chain-nokey-rsa.pem \
	tls-key=./leaf-rsa.pkey \
	tls-generate-host-certificates

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
#https_port 127.2.1.5:8443 \
#	tls-cert=./leaf-chain-nokey-rsa.pem \
#	tls-key=./leaf-rsa.pkey \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

https_port 127.2.2.1:8443 \
	tls-cert=./leaf-root-rsa.pem

https_port 127.2.2.2:8443 \
	tls-cert=./leaf-root-rsa.pem \
	tls-generate-host-certificates=on

https_port 127.2.2.3:8443 \
	tls-cert=./leaf-root-rsa.pem \
	tls-generate-host-certificates=off

https_port 127.2.2.4:8443 \
	tls-cert=./leaf-root-rsa.pem \
	tls-generate-host-certificates

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
#https_port 127.2.2.5:8443 \
#	tls-cert=./leaf-root-rsa.pem \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

https_port 127.3.1.1:8443 \
	tls-cert=./ca-root-rsa.crt \
	tls-key=./ca-root-rsa.pkey

https_port 127.3.1.2:8443 \
	tls-cert=./ca-root-rsa.crt \
	tls-key=./ca-root-rsa.pkey \
	tls-generate-host-certificates=on

https_port 127.3.1.3:8443 \
	tls-cert=./ca-root-rsa.crt \
	tls-key=./ca-root-rsa.pkey \
	tls-generate-host-certificates=off

https_port 127.3.1.4:8443 \
	tls-cert=./ca-root-rsa.crt \
	tls-key=./ca-root-rsa.pkey \
	tls-generate-host-certificates

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
#https_port 127.3.1.5:8443 \
#	tls-cert=./ca-root-rsa.crt \
#	tls-key=./ca-root-rsa.pkey \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

https_port 127.3.2.1:8443 \
	tls-cert=./ca-root-rsa.pem

https_port 127.3.2.2:8443 \
	tls-cert=./ca-root-rsa.pem \
	tls-generate-host-certificates=on

https_port 127.3.2.3:8443 \
	tls-cert=./ca-root-rsa.pem \
	tls-generate-host-certificates=off

https_port 127.3.2.4:8443 \
	tls-cert=./ca-root-rsa.pem \
	tls-generate-host-certificates

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
#https_port 127.3.2.5:8443 \
#	tls-cert=./ca-root-rsa.pem \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

https_port 127.4.1.1:8443 \
	tls-cert=./ca-mid-rsa.crt \
	tls-key=./ca-mid-rsa.pkey

https_port 127.4.1.2:8443 \
	tls-cert=./ca-mid-rsa.crt \
	tls-key=./ca-mid-rsa.pkey \
	tls-generate-host-certificates=on

https_port 127.4.1.3:8443 \
	tls-cert=./ca-mid-rsa.crt \
	tls-key=./ca-mid-rsa.pkey \
	tls-generate-host-certificates=off

https_port 127.4.1.4:8443 \
	tls-cert=./ca-mid-rsa.crt \
	tls-key=./ca-mid-rsa.pkey \
	tls-generate-host-certificates

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
#https_port 127.4.1.5:8443 \
#	tls-cert=./ca-mid-rsa.crt \
#	tls-key=./ca-mid-rsa.pkey \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

https_port 127.4.2.1:8443 \
	tls-cert=./ca-mid-rsa.pem

https_port 127.4.2.2:8443 \
	tls-cert=./ca-mid-rsa.pem \
	tls-generate-host-certificates=on

https_port 127.4.2.3:8443 \
	tls-cert=./ca-mid-rsa.pem \
	tls-generate-host-certificates=off

https_port 127.4.2.4:8443 \
	tls-cert=./ca-mid-rsa.pem \
	tls-generate-host-certificates

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
#https_port 127.4.2.5:8443 \
#	tls-cert=./ca-mid-rsa.pem \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

# FATAL: cert= option must be set before key= is used.
#https_port 127.5.1.1:8443 \
#	tls-key=./leaf-rsa.pkey

# FATAL: cert= option must be set before key= is used.
#https_port 127.5.1.2:8443 \
#	tls-key=./leaf-rsa.pkey \
#	tls-generate-host-certificates=on

# FATAL: cert= option must be set before key= is used.
#https_port 127.5.1.3:8443 \
#	tls-key=./leaf-rsa.pkey \
#	tls-generate-host-certificates=off

# FATAL: cert= option must be set before key= is used.
#https_port 127.5.1.4:8443 \
#	tls-key=./leaf-rsa.pkey \
#	tls-generate-host-certificates

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
# FATAL: cert= option must be set before key= is used.
#https_port 127.5.1.5:8443 \
#	tls-key=./leaf-rsa.pkey \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

# FATAL: https_port requires a cert= parameter
#https_port 127.5.2.1:8443

# FATAL: https_port requires a cert= parameter
#https_port 127.5.2.2:8443 \
#	tls-generate-host-certificates=on

# FATAL: https_port requires a cert= parameter
#https_port 127.5.2.3:8443 \
#	tls-generate-host-certificates=off

# ERROR: Unknown TLS option 'generate-host-certificates=./ca-mid-root-rsa.pem'
# FATAL: https_port requires a cert= parameter
#https_port 127.5.2.4:8443 \
#	tls-generate-host-certificates=./ca-mid-root-rsa.pem

# FATAL: https_port requires a cert= parameter
#https_port 127.5.2.5:8443
